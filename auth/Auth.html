<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Auth</title><link href="ocean.css" rel="stylesheet" type="text/css" title="Ocean" /><script src="haddock-util.js" type="text/javascript"></script><script type="text/javascript">//<![CDATA[
window.onload = function () {pageLoad();setSynopsis("mini_Auth.html");};
//]]>
</script></head><body><div id="package-header"><ul class="links" id="page-menu"><li><a href="index.html">Contents</a></li><li><a href="doc-index.html">Index</a></li></ul><p class="caption" class="empty">&nbsp;</p></div><div id="content"><div id="module-header"><p class="caption">Auth</p></div><div id="table-of-contents"><p class="caption">Contents</p><ul><li><a href="#g:1">Required state
</a></li><li><a href="#g:2">Key management
</a></li><li><a href="#g:3">System hooks, login/logout
</a></li></ul></div><div id="synopsis"><p id="control.syn" class="caption expander" onclick="toggleSection('syn')">Synopsis</p><ul id="section.syn" class="hide" onclick="toggleSection('syn')"><li class="src short"><span class="keyword">class</span> (MonadIO m, FilterMonad Response m, ServerMonad m, HasRqData m, Functor m) =&gt; <a href="#t:AuthMonad">AuthMonad</a> m  <span class="keyword">where</span><ul class="subs"><li><a href="#v:getAuthState">getAuthState</a> :: m <a href="Auth.html#t:AuthState">AuthState</a></li></ul></li><li class="src short"><span class="keyword">data</span>  <a href="#t:AuthState">AuthState</a>  = <a href="#v:MkAuthState">MkAuthState</a> {<ul class="subs"><li><a href="#v:loginForm">loginForm</a> :: String</li><li><a href="#v:loginSecret">loginSecret</a> :: Maybe Key</li><li><a href="#v:loginCookieName">loginCookieName</a> :: Maybe String</li></ul>}</li><li class="src short"><a href="#v:defaultAuthState">defaultAuthState</a> :: <a href="Auth.html#t:AuthState">AuthState</a></li><li class="src short"><a href="#v:getKey">getKey</a> :: FilePath -&gt; IO Key</li><li class="src short"><a href="#v:defaultKeyFile">defaultKeyFile</a> :: FilePath</li><li class="src short"><a href="#v:getDefaultKey">getDefaultKey</a> :: IO Key</li><li class="src short"><a href="#v:initKey">initKey</a> :: ByteString -&gt; Either String Key</li><li class="src short"><a href="#v:setLoggedIn">setLoggedIn</a> :: (SafeCopy user, <a href="Auth.html#t:AuthMonad">AuthMonad</a> m) =&gt; user -&gt; m ()</li><li class="src short"><a href="#v:forwardAfterLogin">forwardAfterLogin</a> :: <a href="Auth.html#t:AuthMonad">AuthMonad</a> m =&gt; String -&gt; m ()</li><li class="src short"><a href="#v:loginData">loginData</a> :: (SafeCopy u, <a href="Auth.html#t:AuthMonad">AuthMonad</a> m) =&gt; m (Maybe u)</li><li class="src short"><a href="#v:requireLoggedIn">requireLoggedIn</a> :: (SafeCopy user, <a href="Auth.html#t:AuthMonad">AuthMonad</a> m) =&gt; m user</li><li class="src short"><a href="#v:setLoggedOut">setLoggedOut</a> ::  m ()</li><li class="src short"><a href="#v:refreshLoggedIn">refreshLoggedIn</a> ::  m ()</li></ul></div><div id="interface"><h1 id="g:1">Required state
</h1><div class="top"><p class="src"><span class="keyword">class</span> (MonadIO m, FilterMonad Response m, ServerMonad m, HasRqData m, Functor m) =&gt; <a name="t:AuthMonad" class="def">AuthMonad</a> m  <span class="keyword">where</span></p><div class="subs methods"><p class="caption">Methods</p><p class="src"><a name="v:getAuthState" class="def">getAuthState</a> :: m <a href="Auth.html#t:AuthState">AuthState</a></p></div></div><div class="top"><p class="src"><span class="keyword">data</span>  <a name="t:AuthState" class="def">AuthState</a>  </p><div class="doc"><p>This type is used to customize how authentication
 works for your site. We recommend building it from the
 <code><a href="Auth.html#v:defaultAuthState">defaultAuthState</a></code> value.
</p></div><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a name="v:MkAuthState" class="def">MkAuthState</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><div class="subs fields"><p class="caption">Fields</p><dl><dt class="src"><a name="v:loginForm" class="def">loginForm</a> :: String</dt><dd class="doc"><p>where to redirect to to handle logins
</p></dd><dt class="src"><a name="v:loginSecret" class="def">loginSecret</a> :: Maybe Key</dt><dd class="doc"><p>key to use for encryption
</p></dd><dt class="src"><a name="v:loginCookieName" class="def">loginCookieName</a> :: Maybe String</dt><dd class="doc"><p>Name of cookie to store authentication data
</p></dd></dl><div class="clear"></div></div></td></tr></table></div></div><div class="top"><p class="src"><a name="v:defaultAuthState" class="def">defaultAuthState</a> :: <a href="Auth.html#t:AuthState">AuthState</a></p></div><h1 id="g:2">Key management
</h1><div class="top"><p class="src"><a name="v:getKey" class="def">getKey</a> :: FilePath -&gt; IO Key</p></div><div class="top"><p class="src"><a name="v:defaultKeyFile" class="def">defaultKeyFile</a> :: FilePath</p></div><div class="top"><p class="src"><a name="v:getDefaultKey" class="def">getDefaultKey</a> :: IO Key</p></div><div class="top"><p class="src"><a name="v:initKey" class="def">initKey</a> :: ByteString -&gt; Either String Key</p></div><h1 id="g:3">System hooks, login/logout
</h1><div class="top"><p class="src"><a name="v:setLoggedIn" class="def">setLoggedIn</a> :: (SafeCopy user, <a href="Auth.html#t:AuthMonad">AuthMonad</a> m) =&gt; user -&gt; m ()</p><div class="doc"><p>NOTE: the passed in user-data is sent to the client
 encrypted. Call this in the handler for your login form.
</p></div></div><div class="top"><p class="src"><a name="v:forwardAfterLogin" class="def">forwardAfterLogin</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: <a href="Auth.html#t:AuthMonad">AuthMonad</a> m</td><td class="doc empty">&nbsp;</td></tr><tr><td class="src">=&gt; String</td><td class="doc"><p>default redirect url
</p></td></tr><tr><td class="src">-&gt; m ()</td><td class="doc empty">&nbsp;</td></tr></table></div><div class="doc"><p>Return a redirect to send the user back where they were
 trying to go when they were bounced to the login form.
 NOTE: You'll lose any post-body data the user was trying
 to submit, so try to require login on the form GET as
 well as the form POST.
</p></div></div><div class="top"><p class="src"><a name="v:loginData" class="def">loginData</a> :: (SafeCopy u, <a href="Auth.html#t:AuthMonad">AuthMonad</a> m) =&gt; m (Maybe u)</p><div class="doc"><p>If there is a logged in user and the session data
 is valid returned the session data.
</p></div></div><div class="top"><p class="src"><a name="v:requireLoggedIn" class="def">requireLoggedIn</a> :: (SafeCopy user, <a href="Auth.html#t:AuthMonad">AuthMonad</a> m) =&gt; m user</p><div class="doc"><p>Return the logged-in user. If a user is not
logged in, they are forwarded to your login page.
After the 
</p></div></div><div class="top"><p class="src"><a name="v:setLoggedOut" class="def">setLoggedOut</a> ::  m ()</p><div class="doc"><p>If a user is logged in, log them out.
 We do not gaurantee this succeeds for a malicious
 user agent.
</p></div></div><div class="top"><p class="src"><a name="v:refreshLoggedIn" class="def">refreshLoggedIn</a> ::  m ()</p><div class="doc"><p>If a user is logged in, refresh their login cookie so they
 can stay logged in. Used for keeping a user active when you want
 to log them out after X minutes for inactivity.
</p></div></div></div></div><div id="footer"><p>Produced by <a href="http://www.haskell.org/haddock/">Haddock</a> version 2.9.2</p></div></body></html>